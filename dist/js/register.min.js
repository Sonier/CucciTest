"use strict";

//创建cookie
function setCookie(key, value, expires) {
  var cookieText = encodeURIComponent(key) + '=' + encodeURIComponent(value) + ';path=/';

  if (!isNaN(expires)) {
    var date = new Date();
    date.setDate(date.getDate() + Number(expires));
    cookieText += ';expires=' + date;
  }

  document.cookie = cookieText;
} //获取cookie


function getCookie(key) {
  var arr = document.cookie.split('; ');

  for (var i = 0, len = arr.length; i < len; i++) {
    var list = arr[i].split('=');

    if (encodeURIComponent(key) === list[0]) {
      return decodeURIComponent(list[1]);
    }
  }
}

var oName = document.getElementById("uname");
var oPas = document.getElementById("upas");
var oRepas = document.getElementById("urepas");
var oPhone = document.getElementById("uphone");
var oSub = document.getElementById("sub");
var oGo = document.getElementById("go");

oSub.onclick = function () {
  var uname = oName.value;
  var upas = oPas.value;

  if (!uname) {
    alert("用户名不能为空！");
    return;
  } // 获取现有的cookie：


  var cookieStr = getCookie("register") ? getCookie("register") : ''; // 转对象：

  var cookieObj = convertStrToObj(cookieStr); // 判断对象中是否存在用户名：

  if (uname in cookieObj) {
    alert("用户名已存在！");
    return;
  } else {
    // 添加到对象中：
    cookieObj[uname] = upas;
  }

  cookieStr = JSON.stringify(cookieObj);
  setCookie("register", cookieStr, 7);
  alert("注册成功！");
  oName.value = "";
  oPas.value = "";
};

oGo.onclick = function () {
  location.href = "../html/login.html";
};